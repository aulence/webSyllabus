var DATAC={url:"json/goodsData.json",loading:'<div class="popBox">              <div class="maskLayer"></div>              <div class="loadingAnim"></div>              </div>'};$(function(){$("#loadData").click(function(){$.getJSON(DATAC.url,function(b){var a=$("#dataTable tbody").children().length==0;if(a){$("body").append(DATAC.loading)}setTimeout(function(){$("#dataTable tbody").html("");getDataInHTML(b);$(".popBox").fadeOut(600,function(){$(this).remove()})},600)})});$(".ckb-all").change(function(){ckdAllInput(this)});$(document).on("change","#dataTable tbody input:checkbox",function(){dataTrCkd(this)});$(document).on("click","#dataTable tbody .delete",function(){deleteConfirm("single",this)});$("#delCkdData").click(function(){deleteConfirm("multiple",this)});sortOrder(0);sortOrder(1);sortOrder(2);sortOrder(3)});function getDataInHTML(e){var b=$("#dataTable tbody"),a=b.children("tr").length,d=e.length;if(a>0){return false}else{for(var c=0;c<d;c++){b.append("<tr></tr>");for(x in e[c]){if(x=="qualityDete"){b.children("tr").eq(c).append("<td>"+e[c][x]+"年</td>")}else{if(x=="price"){b.children("tr").eq(c).append("<td>￥"+parseFloat(e[c][x]).toFixed(2)+"</td>")}else{if(x=="command"){b.children("tr").eq(c).append('<td class="ctrl">'+e[c][x]+"</td>")}else{b.children("tr").eq(c).append("<td>"+e[c][x]+"</td>")}}}}}var f=$(".ckb-all input:checkbox");f.prop("disabled",false).css("cursor","pointer");f[0].indeterminate=false}}function ckdAllInput(c){var b=$(c).children("input").prop("checked"),a=$("#dataTable tbody input:checkbox");if(b){a.prop("checked",true)}else{a.prop("checked",false)}}function dataTrCkd(d){var f=$(".ckb-all input:checkbox"),c=$("#dataTable tbody").children(),e=c.length,a=0;for(var b=0;b<e;b++){if((c.eq(b).find("input:checkbox").prop("checked"))==true){a++}}if(a==0){f.prop("indeterminate",false);f.prop("checked",false)}else{if(a<e){f.prop("indeterminate",true)}else{f[0].indeterminate=false;f.prop("checked",true)}}}function deleteConfirm(a,b){if(a=="single"){var c=$(b).closest("tr");popBox({content:"您确定要删除本行数据吗？",confirm:function(){c.remove();dataTrCkd(b);var d=$("#dataTable tbody").children().length;if(d==0){$("#dataTable thead i.arrow").removeClass("up down")}},cancel:function(){$(".holdCommand").removeClass("holdCommand")}})}else{if(a=="multiple"){popBox({content:"您确定要删除选中的数据吗？",confirm:function(){var d=$("#dataTable tbody input:checkbox:checked").parents("tr");d.fadeOut(300,function(){$(this).remove();dataTrCkd(b);var e=$("#dataTable tbody").children().length;if(e==0){$("#dataTable thead i.arrow").removeClass("up down")}})}})}else{popBox({});$(".popBox").find("#cancel").remove()}}}function popBox(d){d.content=(d.content===undefined?"程序员有点懵-_-!":d.content);d.confirm=(d.confirm===undefined?function(){}:d.confirm);d.cancel=(d.cancel===undefined?function(){}:d.cancel);$("body").append('<div class="popBox"><div class="maskLayer"></div><div class="popBox-main"><div class="popBox-mesg">'+d.content+'</div><div class="popBox-btnGroup"><button id="confirm" type="button">确定</button><button id="cancel" type="button">取消</button></div></div></div>');var b=$(".popBox .popBox-main"),c=b.outerWidth(),a=b.outerHeight();b.css({marginLeft:-(c/2)+"px",marginTop:-(a/2)+"px"});b.fadeIn(600);$(".popBox #confirm").click(function(){d.confirm();$(this).parents(".popBox").fadeOut(600,function(){$(this).remove()})});$(".popBox #cancel").click(function(){d.cancel();$(this).parents(".popBox").fadeOut(600,function(){$(this).remove()})})}function sortOrder(a){$("#dataTable thead i").eq(a).click(function(){var c=$("#dataTable tbody").children().length;if(!c){return}var e=$(this).hasClass("normal"),f=$(this).hasClass("up"),d=$(this).hasClass("down");if(e||d){$(this).removeClass("normal down").addClass("up").parent().siblings().children("i.arrow").removeClass("up down").addClass("normal");if(a==0){$.getJSON(DATAC.url,function(g){g.sort(function(k,j){var i=0,h=0;i=k.id.slice(k.id.lastIndexOf("-")+1);h=j.id.slice(j.id.lastIndexOf("-")+1);return i-h});b(g)})}else{if(a==1){$.getJSON(DATAC.url,function(g){g.sort(function(k,j){var i=0,h=0;i=k.manufacDate.replace(/\-/g,"");h=j.manufacDate.replace(/\-/g,"");return i-h});b(g)})}else{if(a==2){$.getJSON(DATAC.url,function(g){g.sort(function(k,j){var i=0,h=0;i=k.stockDete.replace(/\-/g,"");h=j.stockDete.replace(/\-/g,"");return i-h});b(g)})}else{if(a==3){$.getJSON(DATAC.url,function(g){g.sort(function(k,j){var i=0,h=0;i=k.price;h=j.price;return i-h});b(g)})}else{return}}}}}else{if(f){$(this).removeClass("up").addClass("down").parent().siblings().children("i.arrow").removeClass("up down").addClass("normal");if(a==0){$.getJSON(DATAC.url,function(g){g.sort(function(k,j){var i=0,h=0;i=k.id.slice(k.id.lastIndexOf("-")+1);h=j.id.slice(j.id.lastIndexOf("-")+1);return i-h});b(g,"rev")})}else{if(a==1){$.getJSON(DATAC.url,function(g){g.sort(function(k,j){var i=0,h=0;i=k.manufacDate.replace(/\-/g,"");h=j.manufacDate.replace(/\-/g,"");return i-h});b(g,"rev")})}else{if(a==2){$.getJSON(DATAC.url,function(g){g.sort(function(k,j){var i=0,h=0;i=k.stockDete.replace(/\-/g,"");h=j.stockDete.replace(/\-/g,"");return i-h});b(g,"rev")})}else{if(a==3){$.getJSON(DATAC.url,function(g){g.sort(function(k,j){var i=0,h=0;i=k.price;h=j.price;return i-h});b(g,"rev")})}else{return}}}}}}function b(h,g){if(g=="rev"){h.reverse()}$("body").append(DATAC.loading);setTimeout(function(){$("#dataTable tbody").html("");getDataInHTML(h);$(".popBox").fadeOut(600,function(){$(this).remove()})},600)}})};